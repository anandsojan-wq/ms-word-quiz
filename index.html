<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MS Word Quiz Portal</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        /* --- GEN Z NEON THEME --- */
        :root {
            --bg-dark: #0a0a12;
            --primary-neon: #00fff2; /* Cyan Neon */
            --accent-neon: #bc13fe;  /* Purple Neon */
            --text-glow: 0 0 10px rgba(0, 255, 242, 0.7);
            --glass-dark: rgba(20, 20, 35, 0.85);
            --text: #ffffff;
            --text-muted: #a0a0b0;
            /* Ultra bright neon for correct/wrong */
            --success-neon: #39ff14; 
            --error-neon: #ff073a;
        }

        body {
            margin: 0; font-family: 'Poppins', sans-serif;
            /* Dark background with subtle neon gradient bleeds */
            background: radial-gradient(circle at top left, rgba(188, 19, 254, 0.3), transparent 40%),
                        radial-gradient(circle at bottom right, rgba(0, 255, 242, 0.3), transparent 40%),
                        var(--bg-dark);
            min-height: 100vh; display: flex; align-items: center; justify-content: center;
            padding: 20px; color: var(--text);
        }

        .app-container {
            width: 100%; max-width: 600px;
            /* Dark Glassmorphism */
            background: var(--glass-dark);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 24px; padding: 40px;
            text-align: center; position: relative;
            overflow: hidden;
            /* Neon border and shadow glow */
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 0 30px rgba(0, 255, 242, 0.2), inset 0 0 20px rgba(188, 19, 254, 0.2);
        }

        /* LOGO STYLING */
        .login-logo {
            max-width: 180px;
            height: auto;
            margin-bottom: 25px;
            /* Subtle glowing drop shadow on the logo */
            filter: drop-shadow(0 0 8px var(--accent-neon));
        }

        h1 { 
            margin: 0 0 10px; 
            color: var(--primary-neon); 
            font-weight: 800; 
            text-transform: uppercase;
            letter-spacing: 1px;
            /* Glowing text effect */
            text-shadow: var(--text-glow);
        }
        p { color: var(--text-muted); font-size: 14px; margin-bottom: 30px; font-weight: 500; }

        /* --- Modern Inputs --- */
        input, select {
            width: 100%; padding: 15px; margin-bottom: 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            font-family: inherit; font-weight: 600; box-sizing: border-box;
            outline: none; transition: all 0.3s ease;
            color: var(--text);
        }
        input::placeholder { color: rgba(255, 255, 255, 0.4); }
        select { color: var(--text); }
        option { background: var(--bg-dark); } /* Fix for dark mode selects */

        input:focus, select:focus { 
            border-color: var(--primary-neon); 
            box-shadow: 0 0 20px rgba(0, 255, 242, 0.4);
            background: rgba(0, 255, 242, 0.05);
        }

        /* --- Neon Buttons --- */
        .btn {
            width: 100%; padding: 16px; 
            /* Neon gradient background */
            background: linear-gradient(135deg, var(--accent-neon), var(--primary-neon));
            color: #000; /* Dark text for contrast against bright neon */
            border: none; border-radius: 12px;
            font-weight: 900; font-size: 16px; cursor: pointer;
            transition: all 0.3s ease; text-transform: uppercase;
            box-shadow: 0 0 15px rgba(188, 19, 254, 0.5);
            position: relative; overflow: hidden;
        }
        .btn:hover { 
            transform: translateY(-3px); 
            box-shadow: 0 0 30px rgba(0, 255, 242, 0.8), 0 0 10px rgba(188, 19, 254, 1);
        }
        .btn:active { transform: scale(0.98); }
        .btn:disabled { background: #555; color: #999; box-shadow: none; cursor: not-allowed; }

        .hidden { display: none; }

        /* --- Quiz Styles --- */
        .option-btn {
            background: rgba(255, 255, 255, 0.05); 
            border: 2px solid rgba(255, 255, 255, 0.1);
            color: var(--text);
            padding: 15px; margin-bottom: 12px; width: 100%; text-align: left;
            border-radius: 12px; cursor: pointer; font-weight: 600; transition: all 0.3s;
        }
        .option-btn:hover { 
            border-color: var(--accent-neon); 
            background: rgba(188, 19, 254, 0.1);
            box-shadow: 0 0 15px rgba(188, 19, 254, 0.3);
        }
        /* Intense Neon Correct/Wrong states */
        .correct { 
            background: rgba(57, 255, 20, 0.2) !important; 
            border-color: var(--success-neon) !important; 
            color: var(--success-neon) !important; 
            box-shadow: 0 0 20px var(--success-neon) !important;
        }
        .wrong { 
            background: rgba(255, 7, 58, 0.2) !important; 
            border-color: var(--error-neon) !important; 
            color: var(--error-neon) !important; 
            box-shadow: 0 0 20px var(--error-neon) !important;
        }

        /* Loading Spinner */
        .loader {
            width: 60px; height: 60px; 
            border: 6px solid rgba(255, 255, 255, 0.1);
            border-top: 6px solid var(--primary-neon);
            border-right: 6px solid var(--accent-neon);
            border-radius: 50%;
            animation: spin 0.8s linear infinite; margin: 30px auto;
            box-shadow: 0 0 20px var(--primary-neon);
        }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        /* Topic Grid */
        .chapter-grid {
            display: grid; grid-template-columns: 1fr; gap: 12px;
            text-align: left; margin-bottom: 30px;
            max-height: 350px; overflow-y: auto;
            padding-right: 5px;
        }
        /* Custom Scrollbar for neon look */
        .chapter-grid::-webkit-scrollbar { width: 8px; }
        .chapter-grid::-webkit-scrollbar-track { background: rgba(255,255,255,0.05); border-radius: 10px; }
        .chapter-grid::-webkit-scrollbar-thumb { background: var(--accent-neon); border-radius: 10px; }

        @media (min-width: 500px) {
            .chapter-grid { grid-template-columns: 1fr 1fr; }
        }

        .chapter-btn {
            background: rgba(255, 255, 255, 0.05); 
            border: 2px solid rgba(255, 255, 255, 0.1);
            color: var(--text);
            padding: 15px;
            border-radius: 12px; font-size: 13px; font-weight: 700; cursor: pointer;
            display: flex; align-items: center; justify-content: space-between;
            transition: 0.3s;
        }
        .chapter-btn:hover { 
            border-color: var(--primary-neon);
            box-shadow: 0 0 15px rgba(0, 255, 242, 0.4);
        }
        .chapter-btn.selected { 
            background: linear-gradient(135deg, var(--accent-neon), var(--primary-neon));
            color: #000; 
            border-color: transparent;
            box-shadow: 0 0 20px rgba(0, 255, 242, 0.6);
        }

    </style>
</head>
<body>

    <div class="app-container">
        
        <div id="screen-login">
            <img src="logo.png" alt="Quiz Portal Logo" class="login-logo">
            
            <h1 style="font-size: 32px;">MS Word Quiz</h1>
            <p>Enter your details to enter the neon realm.</p>
            <input type="text" id="inp-name" placeholder="Full Name">
            <input type="tel" id="inp-phone" placeholder="Phone Number" maxlength="10">
            <button class="btn" onclick="goToChapters()">Enter ‚ûù</button>
        </div>

        <div id="screen-chapters" class="hidden">
            <h1>Select Topic</h1>
            <p>Choose a module to generate a quiz.</p>
            <div class="chapter-grid" id="chapter-list"></div>
            <button class="btn" id="start-quiz-btn" onclick="startQuiz()" disabled>Initiate AI Quiz ‚ö°</button>
        </div>

        <div id="screen-loading" class="hidden">
            <h1 style="text-shadow: none; color: var(--text);">Generating...</h1>
            <div class="loader"></div>
            <p>AI is synthesizing 20 unique questions about <br><b style="color:var(--primary-neon)" id="loading-topic">Topic</b>.</p>
        </div>

        <div id="screen-quiz" class="hidden">
            <div style="display:flex; justify-content:space-between; font-size:14px; font-weight:700; margin-bottom:15px; color:var(--text-muted);">
                <span id="q-progress">1 / 20</span>
                <span>Score: <span style="color:var(--primary-neon)" id="live-score">0</span></span>
            </div>
            <h2 id="q-text" style="font-size:20px; margin-bottom:25px; font-weight: 600;">Question text...</h2>
            <div id="options-container"></div>
            <button id="next-btn" class="btn hidden" style="margin-top:20px;" onclick="nextQuestion()">Next Question ‚ûù</button>
        </div>

        <div id="screen-result" class="hidden">
            <h1>Quiz Complete!</h1>
            <div style="font-size:70px; margin:20px 0; text-shadow: 0 0 20px var(--accent-neon);">üíæ</div>
            <p>Your score has been linked to the database.</p>
            <h2 style="font-size:50px; color:var(--primary-neon); margin:0; text-shadow: var(--text-glow);"><span id="final-score">0</span>/20</h2>
            <p style="margin-top:5px;">Total Marks</p>
            <button class="btn" style="margin-top: 20px;" onclick="location.reload()">Take Another Quiz</button>
        </div>

    </div>

<script>
    // ---------------- CONFIGURATION ---------------- //
    
    // ‚úÖ YOUR GOOGLE SCRIPT URL
    const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyGk79tReDKSBGzXK572mQhKhkS84rL0HGj6ioBk_m6mb8G7vfS1Lc_OGPVgckQ-q-eyg/exec"; 

    // ‚úÖ YOUR API KEY
    const API_KEY = "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"; 

    // MS WORD TOPICS
    const chapters = [
        "1. Introduction to Word Processing",
        "2. MS Word Interface",
        "3. File Menu Operations",
        "4. Edit Menu Operations",
        "5. Viewing Documents",
        "6. Insert Menu Features",
        "7. Formatting Features",
        "8. Tools Menu",
        "9. Tables in MS Word",
        "10. Keyboard Shortcuts",
        "11. Help Menu"
    ];

    // ---------------- VARIABLES ---------------- //
    let userDetails = { name: "", phone: "", chapter: "" };
    let questions = [];
    let currentQIndex = 0;
    let score = 0;

    // ---------------- LOGIC ---------------- //

    // 1. LOGIN
    function goToChapters() {
        const name = document.getElementById('inp-name').value;
        const phone = document.getElementById('inp-phone').value;

        if(!name || phone.length < 10) return alert("Please enter valid Name and Phone!");
        
        userDetails.name = name;
        userDetails.phone = phone;

        // Render Chapters
        const grid = document.getElementById('chapter-list');
        grid.innerHTML = "";
        chapters.forEach(chap => {
            const btn = document.createElement('div');
            btn.className = 'chapter-btn';
            btn.innerText = chap;
            btn.onclick = () => selectChapter(btn, chap);
            grid.appendChild(btn);
        });

        switchScreen('screen-chapters');
    }

    function selectChapter(btn, chapName) {
        document.querySelectorAll('.chapter-btn').forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
        userDetails.chapter = chapName;
        document.getElementById('start-quiz-btn').disabled = false;
    }

    // 2. GENERATE QUIZ
    async function startQuiz() {
        switchScreen('screen-loading');
        document.getElementById('loading-topic').innerText = userDetails.chapter;

        const systemPrompt = `You are an IT Teacher specializing in Microsoft Word. 
        Create exactly 20 Multiple Choice Questions (MCQs) on the topic: "${userDetails.chapter}".
        
        Format: JSON Array of objects. 
        Each object must have: { "q": "Question text", "options": ["A", "B", "C", "D"], "correct": "Correct Option Text" }
        
        IMPORTANT:
        - Questions must be specific to MS Word (2016/2019 versions).
        - If topic is 'Keyboard Shortcuts', focus on Ctrl+ keys.
        - Do NOT add markdown blocks. Output raw JSON only.`;

        try {
            const response = await fetch("https://api.groq.com/openai/v1/chat/completions", {
                method: "POST",
                headers: { "Authorization": `Bearer ${API_KEY}`, "Content-Type": "application/json" },
                body: JSON.stringify({
                    model: "llama-3.3-70b-versatile",
                    messages: [{ role: "user", content: systemPrompt }],
                    temperature: 0.5
                })
            });

            const data = await response.json();
            let rawContent = data.choices[0].message.content;
            rawContent = rawContent.replace(/```json/g, "").replace(/```/g, "").trim();
            
            questions = JSON.parse(rawContent);
            
            if(questions.length > 0) {
                currentQIndex = 0; score = 0;
                loadQuestion();
                switchScreen('screen-quiz');
            } else {
                throw new Error("Empty question list");
            }

        } catch (error) {
            console.error(error);
            alert("AI Error. Please try again or check API Key.");
            location.reload();
        }
    }

    // 3. RUN QUIZ
    function loadQuestion() {
        const q = questions[currentQIndex];
        document.getElementById('q-progress').innerText = `${currentQIndex + 1} / ${questions.length}`;
        document.getElementById('live-score').innerText = score;
        document.getElementById('q-text').innerText = q.q;
        document.getElementById('next-btn').classList.add('hidden');

        const container = document.getElementById('options-container');
        container.innerHTML = "";

        q.options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.innerText = opt;
            btn.onclick = () => checkAnswer(btn, opt, q.correct);
            container.appendChild(btn);
        });
    }

    function checkAnswer(btn, selected, correct) {
        const allBtns = document.querySelectorAll('.option-btn');
        allBtns.forEach(b => b.disabled = true);

        if(selected === correct) {
            btn.classList.add('correct');
            score++;
        } else {
            btn.classList.add('wrong');
            allBtns.forEach(b => {
                if(b.innerText === correct) b.classList.add('correct');
            });
        }
        document.getElementById('next-btn').classList.remove('hidden');
    }

    function nextQuestion() {
        currentQIndex++;
        if(currentQIndex < questions.length) {
            loadQuestion();
        } else {
            submitScore();
        }
    }

    // 4. SUBMIT TO GOOGLE SHEET
    function submitScore() {
        switchScreen('screen-loading');
        document.querySelector('#screen-loading h1').innerText = "Submitting Score...";
        document.querySelector('#screen-loading p').innerText = "Sending data to Google Sheets...";

        const payload = {
            name: userDetails.name,
            phone: userDetails.phone,
            chapter: userDetails.chapter,
            score: score
        };

        fetch(GOOGLE_SCRIPT_URL, {
            method: 'POST',
            mode: 'no-cors',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
        }).then(() => {
            document.getElementById('final-score').innerText = score;
            switchScreen('screen-result');
        }).catch(err => {
            alert("Score saved locally (Network Error).");
            document.getElementById('final-score').innerText = score;
            switchScreen('screen-result');
        });
    }

    // UTILS
    function switchScreen(id) {
        document.querySelectorAll('.app-container > div').forEach(div => div.classList.add('hidden'));
        document.getElementById(id).classList.remove('hidden');
    }

</script>

</body>
</html>
